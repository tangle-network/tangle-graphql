# To improve query performance, we strongly suggest adding indexes to any field that you plan to filter or sort by
# Add the `@index` or `@index(unique: true)` annotation after any non-key field
# https://academy.subquery.network/build/graphql.html#indexing-by-non-primary-key-field

"""
Represents an Operator in the system.
"""
type Operator @entity {
  """
  Operator's account ID, serves as the unique identifier.
  """
  id: ID!

  """
  Current status of the Operator (ACTIVE, LEAVING, or OFFLINE).
  """
  currentStatus: OperatorStatus!

  """
  The current stake amount of the Operator.
  """
  currentStake: BigInt!

  """
  The amount of tokens scheduled to be unstaked by the Operator.
  This represents the pending unstake amount that can be released after the unbonding period.
  """
  scheduledUnstakeAmount: BigInt

  """
  History of status changes for the Operator.
  """
  statusHistory: [OperatorStatusChange!]! @derivedFrom(field: "operator")

  """
  History of bond changes for the Operator.
  """
  bondChanges: [OperatorBondChange!]! @derivedFrom(field: "operator")

  """
  The block number when the Operator joined the network.
  """
  joinedAt: Int!

  """
  The block number of the last update to the Operator's information.
  """
  lastUpdateAt: Int!

  """
  List of delegations made to this Operator.
  """
  delegations: [Delegation!] @derivedFrom(field: "operator")
}

"""
Represents a change in the status of an Operator in the network.
"""
type OperatorStatusChange @entity {
  """
  Unique identifier for the status change. Composite key: operator ID + block number
  """
  id: ID!

  """
  The Operator whose status has changed.
  """
  operator: Operator!

  """
  The new status of the Operator.
  """
  status: OperatorStatus!

  """
  The block number at which the status change occurred.
  """
  blockNumber: Int!
}

"""
Enum representing the current status of an Operator in the network.
"""
enum OperatorStatus {
  """
  The Operator is actively participating in the network.
  """
  ACTIVE

  """
  The Operator has initiated the process to leave the network but is still participating.
  """
  LEAVING

  """
  The Operator is not currently participating in the network.
  """
  OFFLINE
}

"""
Represents a change in the bond amount of an Operator in the network.
"""
type OperatorBondChange @entity {
  """
  Unique identifier for the bond change. Composite key: operator ID + block number
  """
  id: ID!

  """
  The Operator whose bond amount has changed.
  """
  operator: Operator!

  """
  The block number at which the bond change occurred.
  """
  blockNumber: Int!

  """
  The amount of the bond change.
  """
  amount: BigInt!

  """
  The type of action that caused the bond change.
  """
  action: BondChangeAction!
}

"""
Enum representing the different types of bond change actions for an Operator.
"""
enum BondChangeAction {
  """
  The Operator has increased their bond amount.
  """
  INCREASE

  """
  The Operator has scheduled a decrease in their bond amount.
  """
  DECREASE_SCHEDULED

  """
  The scheduled decrease in the Operator's bond amount has been executed.
  """
  DECREASE_EXECUTED

  """
  The scheduled decrease in the Operator's bond amount has been cancelled.
  """
  DECREASE_CANCELLED
}
